<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guess What</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Comic Sans MS', cursive;
            background-color: #ffd54f;
        }
        .game-container {
            background-color: #ffffff;
            border-radius: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .btn {
            transition: transform 0.1s;
        }
        .btn:active {
            transform: scale(0.95);
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen">
    <div class="game-container p-8 w-full max-w-2xl">
        <h1 class="text-4xl font-bold text-center mb-6 text-purple-600">Cartoon Drawing Game</h1>
        
        <div class="mb-4 text-center">
            <span id="timer" class="text-2xl font-bold text-red-500">60</span>
            <span class="text-xl"> seconds remaining</span>
        </div>

        <canvas id="drawingCanvas" class="w-full h-96 border-4 border-dashed border-blue-400 rounded-lg"></canvas>

        <div class="flex justify-center space-x-4 mt-4">
            <input type="color" id="colorPicker" class="h-10 w-10 rounded-full">
            <button id="eraser" class="btn bg-yellow-300 text-gray-800 px-4 py-2 rounded-full font-semibold">Eraser</button>
            <button id="clear" class="btn bg-red-400 text-white px-4 py-2 rounded-full font-semibold">Clear All</button>
        </div>
    </div>

    <canvas id="drawingCanvas" width="500" height="500"></canvas>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <script>
        const canvas = document.getElementById('drawingCanvas');
        const context = canvas.getContext('2d');
        const socket = io();

        let timeRemaining = 60;
        let countdown;
        let isTimerRunning = false;
        let drawing = false;
        let erasing = false;
        let currentColor = '#000000';

        context.lineWidth = 5;
        context.lineCap = 'round';

        function startTimer() {
            if (isTimerRunning) return;
            
            isTimerRunning = true;
            timeRemaining = 60;
            document.getElementById('timer').textContent = timeRemaining;

            countdown = setInterval(() => {
                timeRemaining--;
                document.getElementById('timer').textContent = timeRemaining;

                if (timeRemaining <= 0) {
                    clearInterval(countdown);
                    alert('Time is up!');
                    context.clearRect(0, 0, canvas.width, canvas.height);
                    socket.emit('clearCanvas');
                    isTimerRunning = false;
                }
            }, 1000);
        }

        canvas.addEventListener('mousedown', (event) => {
            drawing = true;
            context.beginPath();
            draw(event);
            startTimer();
        });

        canvas.addEventListener('mouseup', () => {
            drawing = false;
            context.beginPath();
        });

        canvas.addEventListener('mousemove', draw);

        function draw(event) {
            if (!drawing) return;

            const rect = canvas.getBoundingClientRect();
            const x = event.clientX - rect.left;
            const y = event.clientY - rect.top;

            context.strokeStyle = erasing ? '#FFFFFF' : currentColor;
            context.lineTo(x, y);
            context.stroke();
            context.beginPath();
            context.moveTo(x, y);

            socket.emit('draw', { x, y, color: context.strokeStyle, erasing });
        }

        socket.on('draw', (data) => {
            context.strokeStyle = data.erasing ? '#FFFFFF' : data.color;
            context.lineTo(data.x, data.y);
            context.stroke();
            context.beginPath();
            context.moveTo(data.x, data.y);
        });

        socket.on('clearCanvas', () => {
            context.clearRect(0, 0, canvas.width, canvas.height);
        });

        document.getElementById('colorPicker').addEventListener('input', (event) => {
            currentColor = event.target.value;
            erasing = false;
        });

        document.getElementById('eraser').addEventListener('click', () => {
            erasing = true;
        });

        document.getElementById('clear').addEventListener('click', () => {
            context.clearRect(0, 0, canvas.width, canvas.height);
            socket.emit('clearCanvas');
        });
    </script>
</body>
</html>